---
title: "dplyr_exo"
author: "Marine"
format: html
---
```{r}
#| message: false
here::i_am("exo_dplyr.Rproj")
library(here)
library(vroom)
library(ggplot2)
library(dplyr)
```

## Exercice 1:

```{r}
bank<- vroom(here("Data","bank-full.csv"))
```

### Question 1: 
```{r}
print(colnames(bank))
```
### Question 2: 
```{r}
print(dim(bank))
```

### Question 3: 
```{r}
bank %>% summary()
```
You have to tell which column and which type of summary you want. 


## Exercise 2

### Question 1: 
```{r}
bank %>% filter(age>50)
```

### Question 2: 
```{r}
bank %>% filter(marital== "married" & education== "secondary")
```
### Question 3:
```{r}
bank %>% filter(age<25 & marital=="single" & education=="tertiary")%>% summary()
```
## Exercise 3:

### Question 1: 
```{r}
bank %>% select(age) %>% summary()
bank %>% pull(age) %>% summary()
```
One is in vertical the other in horizontal. 

### Question 2:
```{r}
bank %>% select(where(is.numeric)) %>% summary()
```
### Question 3: 
```{r}
summarise(bank, median(age))
```

## Exercise 4 
```{r}
life<- vroom(here("Data","life-expectancy-at-birth-who.csv"))
```
### Question 1: 
```{r}
life <-
  life |>
  mutate(diff= Male-Female) 
```

### Question 2:
```{r}
life <-
  life |>
  mutate(reladiff= diff/`Both sexes`) 
```

## Exercise 5: 

### Question 1: 
```{r}
life <-
  life |>
  mutate(X= Female- median(Female)) 
```

### Question 2: 
```{r}
life <-
  life |>
  mutate(Y= Male- (mean(Male)/sd(Male)))
```

### Question 3: 
```{r}
life %>% 
  filter(Year ==2019)%>%
  mutate(Atypical= if_else(`Both sexes`>(median(`Both sexes`)+2*sd(`Both sexes`))|`Both sexes`<(median(`Both sexes`)-2*sd(`Both sexes`)), TRUE, FALSE ))
```
## Exercise 6: 

### Question 1: 
```{r}
bank %>% summarise(mean(age), median(age))
```
### Question 2: 
```{r}
life %>%
  filter(Year==2015)%>%
  summarise(max(Male), min(Male), max(Female), min(Female))
```
## Exercice 7: 

### Question 1: 
```{r}
bank %>% group_by(marital) %>% summarise(median(age))
```
### Question 2: 
```{r}
bank %>% group_by(job) %>% summarise(count=n())
```
### Question 3: 
```{r}
life %>% group_by(Year) %>% summarise(mean(Female), min(Female), max(Female))
```
### Question 4: 
```{r}
life %>% mutate(countries=
       (`Both sexes`<(mean(`Both sexes`)-2*sd(`Both sexes`))))
life %>% group_by(Country)
```

## Exercice 8:

### Question 1: 
```{r}
bank %>% group_by(education) %>% summarise(sum(marital == "married")/n()*100)
```

### Question 2: 
Compute the percentage of persons with a credit default (“yes” in the default variable)
within the groups defined by the status on the housing and loan variables.
```{r}
bank %>% group_by(loan, housing) %>% summarise((sum(default=="yes")/n())*100)
```

